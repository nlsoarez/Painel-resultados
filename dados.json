import json

# Metas estabelecidas
metas = {
    "ETIT_Residencial_Empresarial": 85,
    "ETIT_Movel": 80,
    "Assertividade_Residencial": 98,
    "Assertividade_Movel": 85,
    "DPA": 90
}

# Lista completa de colaboradores
colaboradores = [
    {"Matricula": "F204763", "Nome": "RODRIGO REIS DUARTE", "ETIT": "98%", "Assertividade": "96%", "DPA": "92,76%"},
    {"Matricula": "N6104793", "Nome": "BRUNO MARIANO VILACA", "ETIT": "82%", "Assertividade": "98%", "DPA": "84,61%"},
    {"Matricula": "N6071740", "Nome": "THIAGO BARBOZA DOS SANTOS", "ETIT": "100%", "Assertividade": "100%", "DPA": "-"},
    {"Matricula": "N5819183", "Nome": "RODRIGO PIRES BERNARDINO", "ETIT": "92%", "Assertividade": "-", "DPA": "94,64%"},
    {"Matricula": "N5932064", "Nome": "MONICA DA SILVA RODRIGUES", "ETIT": "88%", "Assertividade": "-", "DPA": "94,55%"},
    {"Matricula": "N0125317", "Nome": "ROBERTO SILVA DO NASCIMENTO", "ETIT": "94%", "Assertividade": "-", "DPA": "99,05%"},
    {"Matricula": "N5737414", "Nome": "SANDRO DA SILVA CARVALHO", "ETIT": "60%", "Assertividade": "100%", "DPA": "93,53%"},
    {"Matricula": "F160641", "Nome": "JENNIFER MARIA ANDRADE SANTOS", "ETIT": "86%", "Assertividade": "85%", "DPA": "87,14%"},
    {"Matricula": "N6173067", "Nome": "JULIANA RIBEIRO GALHÃO", "ETIT": "93%", "Assertividade": "98%", "DPA": "84,20%"},
    {"Matricula": "N5577565", "Nome": "MARISTELLA MARCIA DOS SANTOS", "ETIT": "60%", "Assertividade": "100%", "DPA": "85,65%"},
    {"Matricula": "N5772086", "Nome": "THIAGO PEREIRA DA SILVA", "ETIT": "39%", "Assertividade": "100%", "DPA": "105,54%"},
    {"Matricula": "N5972428", "Nome": "CRISTIANE HERMOGENES DA SILVA", "ETIT": "56%", "Assertividade": "100%", "DPA": "95,16%"},
    {"Matricula": "F201714", "Nome": "FERNANDA MESQUITA DE FREITAS", "ETIT": "63%", "Assertividade": "-", "DPA": "88,88%"},
    {"Matricula": "N5713690", "Nome": "GABRIELA TAVARES DA SILVA", "ETIT": "69%", "Assertividade": "-", "DPA": "118,91%"},
    {"Matricula": "N0239871", "Nome": "LEONARDO FERREIRA LIMA DE ALMEIDA", "ETIT": "67%", "Assertividade": "100%", "DPA": "77,84%"},
    {"Matricula": "N5923996", "Nome": "JULIO CESAR SANTOS SOARES", "ETIT": "100%", "Assertividade": "50%", "DPA": "65,71%"},
    {"Matricula": "N4014011", "Nome": "ALAN MARINHO DIAS", "ETIT": "64%", "Assertividade": "94%", "DPA": "77,64%"},
    {"Matricula": "N0255801", "Nome": "ELBERTON ANICETO HENRIQUE", "ETIT": "58%", "Assertividade": "77%", "DPA": "81,37%"},
    {"Matricula": "N5926003", "Nome": "SUELLEN HERNANDEZ DA SILVA", "ETIT": "75%", "Assertividade": "-", "DPA": "-"},
    {"Matricula": "N6173055", "Nome": "JEFFERSON LUIS GONÇALVES COITINHO", "ETIT": "67%", "Assertividade": "90%", "DPA": "-"},
    {"Matricula": "N5922887", "Nome": "ROMULO BARBOSA NICOLAE", "ETIT": "53%", "Assertividade": "-", "DPA": "69,47%"},
    {"Matricula": "N0189105", "Nome": "IGOR MARCELINO DE MARINS", "ETIT": "83%", "Assertividade": "-", "DPA": "77,99%"},
    {"Matricula": "N5932090", "Nome": "EVILÁZIO ANDRÉ DE MAGALHÃES GOMES PEREIRA", "ETIT": "67%", "Assertividade": "91%", "DPA": "84,30%"},
    {"Matricula": "N0238475", "Nome": "MARLEY MARQUES RIBEIRO", "ETIT": "-", "Assertividade": "-", "DPA": "96,07%"},
    {"Matricula": "N5923221", "Nome": "KELLY PINHEIRO LIRA", "ETIT": "-", "Assertividade": "-", "DPA": "94,55%"},
    {"Matricula": "N6088107", "Nome": "LEANDRO GONÇALVES DE CARVALHO", "ETIT": "-", "Assertividade": "-", "DPA": "84,42%"},
    {"Matricula": "N6172207", "Nome": "CHARLES DOS SANTOS PAIVA", "ETIT": "-", "Assertividade": "-", "DPA": "83,17%"},
    {"Matricula": "N5619600", "Nome": "BRUNO COSTA BUCARD", "ETIT": "-", "Assertividade": "-", "DPA": "82,49%"}
]

# Função para verificar certificação
def esta_certificado(valor, meta):
    if valor == "-" or valor.strip() == "":  # Se não houver valor, considerar não certificado
        return "Não Certificado"
    
    # Removendo "%" e convertendo para float
    valor = float(valor.replace("%", "").replace(",", "."))  # Substitui vírgula por ponto para conversão correta
    
    return "Certificado" if valor >= meta else "Não Certificado"

# Processando os colaboradores
for colaborador in colaboradores:
    etit_meta = metas["ETIT_Residencial_Empresarial"] if colaborador["ETIT"] != "-" else None
    assertividade_meta = metas["Assertividade_Residencial"] if colaborador["Assertividade"] != "-" else None
    dpa_meta = metas["DPA"] if colaborador["DPA"] != "-" else None
    
    colaborador["ETIT_Certificado"] = esta_certificado(colaborador["ETIT"], etit_meta) if etit_meta else "Não Certificado"
    colaborador["Assertividade_Certificado"] = esta_certificado(colaborador["Assertividade"], assertividade_meta) if assertividade_meta else "Não Certificado"
    colaborador["DPA_Certificado"] = esta_certificado(colaborador["DPA"], dpa_meta) if dpa_meta else "Não Certificado"

# Convertendo para JSON formatado
json_resultado = json.dumps(colaboradores, indent=4, ensure_ascii=False)
print(json_resultado)
