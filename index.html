async function buscarResultado() {
    let matricula = document.getElementById("matricula").value.toUpperCase();
    let resultadoElemento = document.getElementById("resultado");

    try {
        let response = await fetch("dados.json");
        if (!response.ok) throw new Error("Erro ao carregar JSON");
        let dados = await response.json();

        let colaborador = dados.colaboradores.find(colab => colab.Matricula === matricula);

        if (colaborador) {
            let setor = colaborador.Setor;
            let etitMeta = setor === "Móvel" ? dados.metas.ETIT_Movel : dados.metas.ETIT_Residencial_Empresarial;
            let assertividadeMeta = setor === "Móvel" ? dados.metas.Assertividade_Movel : dados.metas.Assertividade_Residencial;
            let dpaMeta = dados.metas.DPA;

            let etitValor = colaborador.ETIT !== "-" ? parseFloat(colaborador.ETIT.replace("%", "").replace(",", ".")) : null;
            let assertividadeValor = colaborador.Assertividade !== "-" ? parseFloat(colaborador.Assertividade.replace("%", "").replace(",", ".")) : null;
            let dpaValor = colaborador.DPA !== "-" ? parseFloat(colaborador.DPA.replace("%", "").replace(",", ".")) : null;

            let statusETIT = etitValor !== null && etitValor >= etitMeta ? "✔️" : "❌";
            let statusAssertividade = assertividadeValor !== null && assertividadeValor >= assertividadeMeta ? "✔️" : "❌";
            let statusDPA = dpaValor !== null && dpaValor >= dpaMeta ? "✔️" : "❌";

            let certificado = (statusETIT === "✔️" && statusAssertividade === "✔️" && statusDPA === "✔️");

            resultadoElemento.innerHTML = `
                <strong>Matrícula:</strong> ${colaborador.Matricula} <br>
                <strong>Nome:</strong> ${colaborador.Nome} <br>
                <strong>Setor:</strong> ${setor} <br><br>

                <strong>ETIT:</strong> ${colaborador.ETIT} (Meta: ${etitMeta}%) ${statusETIT} <br>
                <strong>Assertividade:</strong> ${colaborador.Assertividade || 'N/A'} (Meta: ${assertividadeMeta}%) ${statusAssertividade} <br>
                <strong>DPA:</strong> ${colaborador.DPA || 'N/A'} (Meta: ${dpaMeta}%) ${statusDPA} <br><br>

                <span class="${certificado ? 'certificado' : 'nao-certificado'}">
                    ${certificado ? "✅ Certificado" : "❌ Não Certificado"}
                </span>
            `;
        } else {
            resultadoElemento.innerHTML = "Matrícula não encontrada.";
        }
    } catch (error) {
        resultadoElemento.innerHTML = "Erro ao carregar os dados.";
        console.error("Erro:", error);
    }
}
